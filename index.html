<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Congress Presider Elite</title>
    <style>
        :root {
            --primary: #0071e3;
            --primary-dark: #0062c4;
            --secondary: #34c759;
            --danger: #ff3b30;
            --bg: #f5f5f7;
            --card-bg: rgba(255, 255, 255, 0.8);
            --text: #1d1d1f;
            --text-light: #86868b;
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* Overlay for sheet input */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: var(--transition);
        }

        .overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .overlay-content {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 2.5rem;
            width: 90%;
            max-width: 600px;
            text-align: center;
            transform: translateY(20px);
            transition: var(--transition);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .overlay.hidden .overlay-content {
            transform: translateY(-20px);
        }

        .overlay h1 {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .overlay p {
            color: var(--text-light);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .sheet-input {
            display: flex;
            gap: 1rem;
            width: 100%;
        }

        #sheetUrl {
            flex: 1;
            padding: 1rem;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 1rem;
            transition: var(--transition);
        }

        #sheetUrl:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
        }

        #loadSheet {
            padding: 1rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
        }

        #loadSheet:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* Main content */
        .main-content {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Sheet container */
        .sheet-container {
            flex: 1;
            position: relative;
            overflow: auto;
            background: white;
        }

        #sheet-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Floating timer */
        .timer-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 18px;
            padding: 1.5rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            z-index: 100;
            transition: var(--transition);
            cursor: move;
            user-select: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .timer-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .timer-header h2 {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .timer-display {
            font-family: 'SF Mono', 'Roboto Mono', monospace;
            font-size: 2.5rem;
            font-weight: 600;
            text-align: center;
            margin: 1rem 0;
            letter-spacing: 1px;
        }

        .timer-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        .timer-btn {
            padding: 0.75rem;
            border: none;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .start-btn {
            background: var(--secondary);
            color: white;
        }

        .stop-btn {
            background: var(--danger);
            color: white;
        }

        .reset-btn {
            background: #e5e5ea;
            color: var(--text);
        }

        .timer-btn:hover {
            transform: translateY(-2px);
        }

        .timer-btn:active {
            transform: translateY(0);
        }

        /* Status bar */
        .status-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 44px;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 50;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 0 1rem;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-link {
            color: var(--text);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            padding: 0.5rem 0;
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary);
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: var(--transition);
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .status-time {
            font-family: 'SF Mono', 'Roboto Mono', monospace;
            font-size: 0.9rem;
        }

        /* Modal styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            pointer-events: none;
            transition: var(--transition);
        }

        .modal.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 2rem;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: var(--transition);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--danger);
            transform: rotate(90deg);
        }

        /* Motions table */
        .motions-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .motions-table th, .motions-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .motions-table th {
            background: rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }

        .motions-table tr:hover {
            background: rgba(0, 0, 0, 0.03);
        }

        /* Script content */
        .script-content {
            line-height: 1.6;
        }

        .script-section {
            margin-bottom: 1.5rem;
        }

        .script-section h3 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        /* Settings */
        .settings-option {
            margin-bottom: 1.5rem;
        }

        .settings-option label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .settings-option input, .settings-option select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 1rem;
        }

        .save-settings {
            padding: 0.75rem 1.5rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 1rem;
        }

        .save-settings:hover {
            background: var(--primary-dark);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .overlay-content {
                padding: 1.5rem;
            }
            
            .overlay h1 {
                font-size: 1.8rem;
            }
            
            .sheet-input {
                flex-direction: column;
            }
            
            .timer-container {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
                width: auto;
            }

            .nav-links {
                gap: 0.75rem;
            }

            .modal-content {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Overlay for sheet input -->
    <div class="overlay" id="overlay">
        <div class="overlay-content">
            <h1>Congress Presider Elite</h1>
            <p>Paste your Google Sheet link to begin your session</p>
            <div class="sheet-input">
                <input type="text" id="sheetUrl" placeholder="https://docs.google.com/spreadsheets/d/...">
                <button id="loadSheet">Load Sheet</button>
            </div>
        </div>
    </div>

    <!-- Status bar with navigation -->
    <div class="status-bar">
        <div class="nav-links">
            <a href="#" class="nav-link" id="toggleTimer">Toggle Timer</a>
            <a href="#" class="nav-link" id="showMotions">Motions Guide</a>
            <a href="#" class="nav-link" id="showScripts">PO Scripts</a>
            <a href="#" class="nav-link" id="showSettings">Settings</a>
        </div>
        <div class="status-time" id="currentTime"></div>
    </div>

    <!-- Main content -->
    <div class="main-content">
        <div class="sheet-container">
            <iframe id="sheet-iframe"></iframe>
        </div>
    </div>

    <!-- Floating timer -->
    <div class="timer-container" id="timerPanel">
        <div class="timer-header">
            <h2>Congress Timer</h2>
        </div>
        <div class="timer-display" id="timer">00:00:00.000</div>
        <div class="timer-buttons">
            <button class="timer-btn start-btn" id="startBtn">Start</button>
            <button class="timer-btn stop-btn" id="stopBtn">Stop</button>
            <button class="timer-btn reset-btn" id="resetBtn">Reset</button>
        </div>
    </div>

    <!-- Motions Guide Modal -->
    <div class="modal" id="motionsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Congress Motions Guide</h2>
                <button class="close-modal" id="closeMotions">&times;</button>
            </div>
            <table class="motions-table">
                <thead>
                    <tr>
                        <th>Motion</th>
                        <th>Purpose</th>
                        <th>Required Vote</th>
                        <th>Debatable</th>
                        <th>Amendable</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Previous Question</td>
                        <td>To end debate and vote immediately</td>
                        <td>2/3</td>
                        <td>No</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Table</td>
                        <td>To set aside pending legislation</td>
                        <td>Majority</td>
                        <td>No</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Extend Debate</td>
                        <td>To add time to debate</td>
                        <td>2/3</td>
                        <td>No</td>
                        <td>Yes</td>
                    </tr>
                    <tr>
                        <td>Point of Order</td>
                        <td>To correct parliamentary error</td>
                        <td>None (PO rules)</td>
                        <td>No</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Point of Personal Privilege</td>
                        <td>To address personal comfort</td>
                        <td>None (PO rules)</td>
                        <td>No</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Suspend the Rules</td>
                        <td>To temporarily suspend rules</td>
                        <td>2/3</td>
                        <td>No</td>
                        <td>No</td>
                    </tr>
                    <tr>
                        <td>Division of the Question</td>
                        <td>To split legislation into parts</td>
                        <td>Majority</td>
                        <td>No</td>
                        <td>Yes</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- PO Scripts Modal -->
    <div class="modal" id="scriptsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Presiding Officer Scripts</h2>
<button class="close-modal" id="closeScripts">&times;</button>
</div>
<div class="script-content">
    <div class="script-section">
        <h3>Explaining Procedure</h3>
        <p>1 tap at two minutes</p>
        <p>2 taps at two minutes 30</p>
        <p>3 taps at two minutes 50</p>
        <p>AT 3 minutes I will gavel you down</p>
        <p>At 3 minutes 10 seconds, I will verbally cut you off</p>
    </div>
    
    <div class="script-section">
        <h3>Questioning Procedure</h3>
        <p>1. First aff and first neg have 4 blocks of 30 seconds</p>
        <p>2. All other aff and neg speeches have 2 blocks</p>
        <p>3. 1 tap at 20 seconds elapsed, 2 hard taps at 30 seconds elapsed, and I will call on the next questioner</p>
        <p>4. If I am pointing at you with the other end of the gavel, that means you are the next questioner</p>
    </div>
    
    <div class="script-section">
        <h3>General Instructions</h3>
        <p>Let's make this an efficient chamber. Raise your placards high where I can see them and keep motions and points of personal privilege right after question blocks have elapsed.</p>
        <p>Are there any questions?</p>
    </div>
    
    <div class="script-section">
        <h3>Handling Motions</h3>
        <p>Are there any motions? (Docket Nomination) - Call on one of the senators who made a motion and say, "State your motion." They will say, "I move to open the floor for docket nomination."</p>
        <p>Then you say, "Any seconds?" if nobody seconds already.</p>
        <p>"All in favor say 'Aye', any against say 'Nay'."</p>
        <p>"The floor is now open." (They will state a motion.) Call on one of them and write their nomination.</p>
        <p>"Any other motions? (Close floor for docket nomination) Any seconds? All in favor say 'Aye', against say 'Nay'."</p>
        <p>"Very well, we will be starting with the docket: [Legislation Name]."</p>
    </div>
    
    <div class="script-section">
        <h3>Tracking Precedence</h3>
        <p>Before we start, if anyone would like to keep track of their precedence, you can follow along with my sheet, just type in tinyurl.com/mhsaacongress</p>
    </div>
    
    <div class="script-section">
        <h3>Beginning Debate</h3>
        <p>"Great, first legislation on the table: [Legislation Name]. Any sponsorship speeches? Any authorship speeches (if no sponsorship)? Any first aff (if no author)?"</p>
        <p>After speech: "Thank you, senator, for this speech of 3 minutes and [time]. We are now open for 4 or 2 blocks of questioning. All questioners please rise now." *Gavel tap*</p>
    </div>
    
    <div class="script-section">
        <h3>Continuing Debate</h3>
        <p>After the last question: "Seeing as that was the [1st/2nd/3rd/4th] speech in the [affirmation/negation], we are now in line for the next speech in the [affirmation/negation]. All willing to give that speech, please rise now." *Gavel tap*</p>
        <p>Repeat process until a motion to move to the previous question is made.</p>
    </div>
    
    <div class="script-section">
        <h3>Moving to Previous Question</h3>
        <p>"All willing to move to the previous question, raise your placards. All against? Any abstentions?"</p>
        <p>If it does not pass: "That does not meet our 2/3 majority; therefore, we will continue debate on this legislation."</p>
        <p>If it passes: "Very well. All willing to pass this legislation, raise your placards."</p>
        <p>At the end: "On a vote of [X]-[Y]-[Z], this bill does indeed [fail/pass]."</p>
    </div>
    
    <div class="script-section">
        <h3>Calling for a Recess</h3>
        <p>"Motion to move to a 5-minute recess. Any seconds? All willing to move to a 5-minute recess, say 'Aye'. Any against?"</p>
        <p>"Please be back by [Time]"</p>
    </div>
</div>
    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="close-modal" id="closeSettings">&times;</button>
            </div>
            <div class="settings-option">
                <label for="timerPosition">Timer Position</label>
                <select id="timerPosition">
                    <option value="bottom-right">Bottom Right</option>
                    <option value="bottom-left">Bottom Left</option>
                    <option value="top-right">Top Right</option>
                    <option value="top-left">Top Left</option>
                </select>
            </div>
            <div class="settings-option">
                <label for="timeFormat">Time Format</label>
                <select id="timeFormat">
                    <option value="12">12-hour</option>
                    <option value="24">24-hour</option>
                </select>
            </div>
            <div class="settings-option">
                <label for="defaultSheet">Default Sheet URL</label>
                <input type="text" id="defaultSheet" placeholder="Paste default sheet URL">
            </div>
            <button class="save-settings" id="saveSettings">Save Settings</button>
        </div>
    </div>

    <script>
        // ======================
        // Google Sheet Loader
        // ======================
        const overlay = document.getElementById('overlay');
        const sheetUrlInput = document.getElementById('sheetUrl');
        const loadSheetBtn = document.getElementById('loadSheet');
        const sheetIframe = document.getElementById('sheet-iframe');
        
        loadSheetBtn.addEventListener('click', loadSheet);
        sheetUrlInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') loadSheet();
        });
        
        function loadSheet() {
            const url = sheetUrlInput.value.trim();
            let sheetId = '';
            
            // Extract sheet ID from URL
            if (url.includes('/d/')) {
                sheetId = url.split('/d/')[1].split('/')[0];
            } else if (url.includes('id=')) {
                sheetId = url.split('id=')[1].split('&')[0];
            } else {
                sheetId = url; // Assume raw ID was entered
            }
            
            if (sheetId) {
                const embedUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/edit?usp=sharing`;
                sheetIframe.src = embedUrl;
                localStorage.setItem('lastSheetUrl', sheetId);
                
                // Hide overlay with animation
                overlay.classList.add('hidden');
                setTimeout(() => {
                    overlay.style.display = 'none';
                }, 400);
            } else {
                // Shake animation for error
                sheetUrlInput.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    sheetUrlInput.style.animation = '';
                }, 500);
            }
        }
        
        // Load last used sheet if available
        window.addEventListener('load', function() {
            const lastSheetId = localStorage.getItem('lastSheetUrl');
            if (lastSheetId) {
                sheetIframe.src = `https://docs.google.com/spreadsheets/d/${lastSheetId}/edit?usp=sharing`;
                overlay.style.display = 'none';
                overlay.classList.add('hidden');
            }
            
            // Load settings
            loadSettings();
            
            // Update current time
            updateTime();
            setInterval(updateTime, 1000);
        });
        
        function updateTime() {
            const now = new Date();
            const timeFormat = localStorage.getItem('timeFormat') || '12';
            
            let hours = now.getHours();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            
            if (timeFormat === '12') {
                hours = hours % 12;
                hours = hours ? hours : 12; // the hour '0' should be '12'
                document.getElementById('currentTime').textContent = 
                    `${hours}:${String(now.getMinutes()).padStart(2, '0')} ${ampm}`;
            } else {
                document.getElementById('currentTime').textContent = 
                    `${String(hours).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
            }
        }
        
        // ======================
        // Draggable Timer
        // ======================
        const timerPanel = document.getElementById('timerPanel');
        let isDragging = false;
        let offsetX, offsetY;
        
        timerPanel.addEventListener('mousedown', startDrag);
        timerPanel.addEventListener('touchstart', startDrag);
        
        function startDrag(e) {
            isDragging = true;
            const rect = timerPanel.getBoundingClientRect();
            offsetX = (e.clientX || e.touches[0].clientX) - rect.left;
            offsetY = (e.clientY || e.touches[0].clientY) - rect.top;
            timerPanel.style.cursor = 'grabbing';
            timerPanel.style.transition = 'none';
            e.preventDefault();
        }
        
        function drag(e) {
            if (!isDragging) return;
            const x = (e.clientX || e.touches[0].clientX) - offsetX;
            const y = (e.clientY || e.touches[0].clientY) - offsetY;
            
            // Boundary checking
            const maxX = window.innerWidth - timerPanel.offsetWidth;
            const maxY = window.innerHeight - timerPanel.offsetHeight;
            
            timerPanel.style.left = `${Math.max(10, Math.min(x, maxX - 10))}px`;
            timerPanel.style.top = `${Math.max(10, Math.min(y, maxY - 10))}px`;
        }
        
        function stopDrag() {
            isDragging = false;
            timerPanel.style.cursor = 'grab';
            timerPanel.style.transition = 'var(--transition)';
            
            // Save timer position
            localStorage.setItem('timerPosition', JSON.stringify({
                left: timerPanel.style.left,
                top: timerPanel.style.top
            }));
        }
        
        document.addEventListener('mousemove', drag);
        document.addEventListener('touchmove', drag);
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('touchend', stopDrag);
        
        // ======================
        // Timer Functionality
        // ======================
        let timerInterval;
        let startTime;
        let elapsedTime = 0;
        let isRunning = false;
        const timerDisplay = document.getElementById('timer');
        
        function startTimer() {
            if (!isRunning) {
                startTime = Date.now() - elapsedTime;
                timerInterval = setInterval(updateTimer, 10);
                isRunning = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
                
                // Animation
                timerPanel.style.animation = 'pulse 2s infinite';
            }
        }
        
        function stopTimer() {
            if (isRunning) {
                clearInterval(timerInterval);
                isRunning = false;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('stopBtn').disabled = true;
                timerPanel.style.animation = '';
            }
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            elapsedTime = 0;
            timerDisplay.textContent = '00:00:00.000';
            document.getElementById('startBtn').disabled = false;
            document.getElementById('stopBtn').disabled = true;
            timerPanel.style.animation = '';
        }
        
        function updateTimer() {
            elapsedTime = Date.now() - startTime;
            const totalSecs = Math.floor(elapsedTime / 1000);
            const hours = Math.floor(totalSecs / 3600);
            const minutes = Math.floor((totalSecs % 3600) / 60);
            const seconds = totalSecs % 60;
            const millis = Math.floor((elapsedTime % 1000) / 10);
            
            timerDisplay.textContent = 
                `${String(hours).padStart(2, '0')}:` +
                `${String(minutes).padStart(2, '0')}:` +
                `${String(seconds).padStart(2, '0')}.` +
                `${String(millis).padStart(2, '0')}`;
        }
        
        document.getElementById('startBtn').addEventListener('click', startTimer);
        document.getElementById('stopBtn').addEventListener('click', stopTimer);
        document.getElementById('resetBtn').addEventListener('click', resetTimer);
        
        // Initialize with stop button disabled
        document.getElementById('stopBtn').disabled = true;
        
        // ======================
        // Modal Functionality
        // ======================
        const motionsModal = document.getElementById('motionsModal');
        const scriptsModal = document.getElementById('scriptsModal');
        const settingsModal = document.getElementById('settingsModal');
        
        document.getElementById('showMotions').addEventListener('click', () => {
            motionsModal.classList.add('active');
        });
        
        document.getElementById('showScripts').addEventListener('click', () => {
            scriptsModal.classList.add('active');
        });
        
        document.getElementById('showSettings').addEventListener('click', () => {
            settingsModal.classList.add('active');
        });
        
        document.getElementById('closeMotions').addEventListener('click', () => {
            motionsModal.classList.remove('active');
        });
        
        document.getElementById('closeScripts').addEventListener('click', () => {
            scriptsModal.classList.remove('active');
        });
        
        document.getElementById('closeSettings').addEventListener('click', () => {
            settingsModal.classList.remove('active');
        });
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === motionsModal) {
                motionsModal.classList.remove('active');
            }
            if (e.target === scriptsModal) {
                scriptsModal.classList.remove('active');
            }
            if (e.target === settingsModal) {
                settingsModal.classList.remove('active');
            }
        });
        
        // ======================
        // Toggle Timer
        // ======================
        document.getElementById('toggleTimer').addEventListener('click', () => {
            timerPanel.style.display = timerPanel.style.display === 'none' ? 'block' : 'none';
            localStorage.setItem('timerVisible', timerPanel.style.display !== 'none');
        });
        
        // ======================
        // Settings
        // ======================
        function loadSettings() {
            // Timer visibility
            const timerVisible = localStorage.getItem('timerVisible');
            if (timerVisible === 'false') {
                timerPanel.style.display = 'none';
            }
            
            // Timer position
            const timerPosition = localStorage.getItem('timerPosition');
            if (timerPosition) {
                const position = JSON.parse(timerPosition);
                timerPanel.style.left = position.left;
                timerPanel.style.top = position.top;
                timerPanel.style.right = 'auto';
                timerPanel.style.bottom = 'auto';
            }
            
            // Time format
            const timeFormat = localStorage.getItem('timeFormat');
            if (timeFormat) {
                document.getElementById('timeFormat').value = timeFormat;
            }
            
            // Default sheet
            const defaultSheet = localStorage.getItem('defaultSheet');
            if (defaultSheet) {
                document.getElementById('defaultSheet').value = defaultSheet;
            }
        }
        
        document.getElementById('saveSettings').addEventListener('click', () => {
            // Save time format
            const timeFormat = document.getElementById('timeFormat').value;
            localStorage.setItem('timeFormat', timeFormat);
            
            // Save default sheet
            const defaultSheet = document.getElementById('defaultSheet').value;
            localStorage.setItem('defaultSheet', defaultSheet);
            
            // Save timer position
            const timerPosition = document.getElementById('timerPosition').value;
            let position = {};
            
            switch(timerPosition) {
                case 'bottom-right':
                    timerPanel.style.right = '2rem';
                    timerPanel.style.bottom = '2rem';
                    timerPanel.style.left = 'auto';
                    timerPanel.style.top = 'auto';
                    break;
                case 'bottom-left':
                    timerPanel.style.left = '2rem';
                    timerPanel.style.bottom = '2rem';
                    timerPanel.style.right = 'auto';
                    timerPanel.style.top = 'auto';
                    break;
                case 'top-right':
                    timerPanel.style.right = '2rem';
                    timerPanel.style.top = '4rem';
                    timerPanel.style.left = 'auto';
                    timerPanel.style.bottom = 'auto';
                    break;
                case 'top-left':
                    timerPanel.style.left = '2rem';
                    timerPanel.style.top = '4rem';
                    timerPanel.style.right = 'auto';
                    timerPanel.style.bottom = 'auto';
                    break;
            }
            
            localStorage.setItem('timerPosition', JSON.stringify({
                left: timerPanel.style.left,
                top: timerPanel.style.top,
                right: timerPanel.style.right,
                bottom: timerPanel.style.bottom
            }));
            
            // Update time display immediately
            updateTime();
            
            // Close settings modal
            settingsModal.classList.remove('active');
        });
        
        // Add shake animation to CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                20%, 60% { transform: translateX(-5px); }
                40%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
        
